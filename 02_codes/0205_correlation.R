#-------------------------------------------------------------------
# Project: 
# Organization: 
# Objective: Correlation
# Author: Valeria Egorova
# Date: 03 July 2024
#-------------------------------------------------------------------

cor_m <- 
  data_with_cl %>%
  select(age, exp_y, task_CISS,	em_CISS, av_CISS,	distr_CISS, int_coping, 
         sdistr_CISS,	stress,	abil,	vpyl,	nast,	obid,	neust,
         bescom,	mstit,	neter,	podoz,	poza,	nega,	confl,	sit_tr,	lich_t)

corr_matrix2 <- cor(cor_m)

colnames(corr_matrix2) <- c("Возраст", "Стаж", "ПОК",	"ЭОК", "Избегание",	"Отвлечение", "ОПК",
                 "Сциальное отвлечение",	"Стрессоустойчивость",	
                 "Социальный самоконтроль",	"Вспыльчивость",	"Наступательность",	
                 "Обидчивость",	"Неуступчивость","Бескомпромиссность",
                 "Мстительность",	"Нетерпимость",	"Подозрительность",	
                 "ПА",	"НА",	"Конфликтность",	"СТ",	"ЛТ")
rownames(corr_matrix2) <- c("Возраст", "Стаж", "ПОК",	"ЭОК", "Избегание",	"Отвлечение","ОПК",
                 "Сциальное отвлечение",	"Стрессоустойчивость",	
                 "Социальный самоконтроль",	"Вспыльчивость",	"Наступательность",	
                 "Обидчивость",	"Неуступчивость","Бескомпромиссность",
                 "Мстительность",	"Нетерпимость",	"Подозрительность",	
                 "ПА",	"НА",	"Конфликтность",	"СТ",	"ЛТ")

p.mat2 = cor_pmat(cor_m)

colnames(p.mat2) <- c("Возраст", "Стаж", "ПОК",	"ЭОК", "Избегание",	"Отвлечение", "ОПК",
                      "Сциальное отвлечение",	"Стрессоустойчивость",	
                      "Социальный самоконтроль",	"Вспыльчивость",	"Наступательность",	
                      "Обидчивость",	"Неуступчивость","Бескомпромиссность",
                      "Мстительность",	"Нетерпимость",	"Подозрительность",	
                      "ПА",	"НА",	"Конфликтность",	"СТ",	"ЛТ")
rownames(p.mat2) <- c("Возраст", "Стаж", "ПОК",	"ЭОК", "Избегание",	"Отвлечение", "ОПК",
                      "Сциальное отвлечение",	"Стрессоустойчивость",	
                      "Социальный самоконтроль",	"Вспыльчивость",	"Наступательность",	
                      "Обидчивость",	"Неуступчивость","Бескомпромиссность",
                      "Мстительность",	"Нетерпимость",	"Подозрительность",	
                      "ПА",	"НА",	"Конфликтность",	"СТ",	"ЛТ")

ggcorrplot(corr_matrix2,  type = "lower", colors = c("#6D9EC1", "white", "#E46726"),
           lab = TRUE, p.mat = p.mat2, legend.title = "Сила связи",
           tl.cex = 10, lab_size = 2.5) +
  theme(axis.text = element_text(color = "black"))

